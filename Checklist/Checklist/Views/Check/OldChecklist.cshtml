@model Checklist.Models.AnswerForm
@Styles.Render("~/Content/Site.css")

<h2>@ViewBag.Message</h2>

@{
    bool edit = true;
    
    if(User.Identity.Name == "admin")
    {
        edit = false;
    }
}



<table>
    <tr>
        <td>Date of Visit:@Model.dateCreated.ToString("MM/dd/yyyy")</td>
        <td>Last Modified:@Model.dateModified.ToString("MM/dd/yyyy")</td>
    </tr>
    <tr>
        <td>Business Consultant: @User.Identity.Name </td>
        <td>Restaurant: @ViewBag.Location</td>
    </tr>
</table>


@using (Html.BeginForm("SendConfirmation", "Check"))
{
    <table>
        <tr>
            <td>Manager on Duty: @Html.EditorFor(m => m.managerOnDuty)</td>
            <td>General Manager: @Html.EditorFor(m => m.generalManager)</td>
        </tr>
    </table>

    
    @Html.HiddenFor(m => m.locationID, Model.locationID);
    @Html.HiddenFor(m => m.formID, Model.formID);
    @Html.HiddenFor(m => m.dateModified, Model.dateModified);
    @Html.HiddenFor(m => m.siteVisitID, Model.siteVisitID);
   
    <table id="list">
        @{int previous = -1;}
        @foreach (var ans in Model.answerList)
        {
            if (ans.question == null)
            {
                continue;
            }

            if (ans.question.SectionID != previous)
            {
                previous = ans.question.SectionID;
            <tr>
                <td>
                    <h2>@ans.sectionName</h2>
                </td>
                <td>Poor</td>
                <td>Good</td>
                <td>Excellent</td>
                <td>N/A</td>
                <td>Comments:</td>
            </tr>
            }
            
            <tr>

                @{
            int x = ans.question.QuestionID - 1;
                }
                @Html.HiddenFor(m => m.answerList[x].questionID, ans.questionID)
                <td>@ans.question.QuestionName</td>
                <td>@Html.RadioButtonFor(m => m.answerList[x].value, 1)</td>
                <td>@Html.RadioButtonFor(m => m.answerList[x].value, 2)</td>
                <td>@Html.RadioButtonFor(m => m.answerList[x].value, 3)</td>
                <td>@Html.RadioButtonFor(m => m.answerList[x].value, 4)</td>
                <td>@Html.EditorFor(m => m.answerList[x].comment)</td>
            </tr>
        }
    </table>
    
    <h2>Action Items ***NOT WORKING***</h2>

    @Html.Action("DisplayActionItems", new { loc = Model.locationID });
    <button type="submit">New Action Item</button>

    <h2>Public Comments</h2>
    @Html.TextAreaFor(m => m.publicComment, new { rows = "8", cols = "700" })

    <h2>Private Comments</h2>
    @Html.TextAreaFor(m => m.privateComment, new { rows = "8", cols = "700" })

    <br />
    <button type="submit">Send</button>
}

@using (Html.BeginForm("LocationInfo", "Check", new { locationId = Model.locationID }))
{
    <button type="submit">Back to Location Info</button>
}


@using (Html.BeginForm("PreviousChecklists", "Check", new { locationId = Model.locationID }))
{
    <button type ="submit">Back to Previous Checklists</button>
}